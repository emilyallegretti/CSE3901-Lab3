<% if current_user.role == "admin" %>
    <h1>CSE Student Grader Applications</h1>
    <table id = "applicationTable" class = "table">
        <thread>
            <tr id = "headerRow" class = "text-center">
                <th>Student Name</th> <th>Term</th> <th>Campus</th> <th colspan = "3" >Actions</th>
            </tr>
        </thread>
        <tbody> 
            <% @applications.each do |application| %>
                <tr> 
                    <td><%= application.user.fname %> <%= application.user.lname %></td>
                    <td><%= application.term %></td>
                    <td><%= application.campus %></td>
                    <td><%= link_to 'Show', grader_application_path(application) %></td>
                    <td><%= button_to 'Approve', grader_application_path(application), method: :patch %>
                    <td><%= button_to 'Reject', grader_application_path(application), method: :delete, data: {turbo_confirm: "Are you sure you want to reject this application?"} %>
                </tr>
            <% end %>
        </tbody>
    </table>
<% elsif current_user.role == "student" %>
    <h2>CSE Student Grader Applications</h2>
    <% if @applications.length > 0 %>
        <p>
            You currently have application(s) on record to be a student grader. They are listed below.
            <br>You must submit a new application for each semester of courses.
            <br>Once an application has been approved and you are assigned to a section for the specified term, the status of your application will be updated.
            <br>You may view or delete each of your applications here.
        </p>
        <table id="applicationTable" class="table"> 
            <thread>
                <tr id="headerRow" class="text-center"> 
                    <th>Student Name</th> <th>Term</th> <th>Campus</th> <th colspan = "2">Actions</th> <th>Status</th>
                </tr>
            </thread>
            <tbody> 
                <% @applications.each do |application| %>
                    <tr> 
                        <td><%= application.user.fname %> <%= application.user.lname %></td>
                        <td><%= application.term %></td>
                        <td><%= application.campus %></td>
                        <td><%= link_to 'Show', grader_application_path(application) %></td>
                        <td><%= button_to 'Delete', grader_application_path(application), method: :delete, data: {turbo_confirm: "Are you sure you want to delete this application?"} %></td>
                        <td>
                            <% if application.is_accepted == true %>
                                <%= "Accepted" %>
                            <% else %>
                                <%= "Pending" %>
                            <% end %>
                        </td>
                    </tr>
                <% end %>
            </tbody>
        </table>
        <p>
            <br>Apply for another term:
        </p>
        <%= link_to "New Application", new_grader_application_path %>
    <% else %>
        <p>
            You currently have no active applications on record for a CSE student grader position.
            <br>Start a new application:
        </p>
        <%= link_to "New Application", new_grader_application_path %>
    <% end %>
<% end %>

<%== pagy_bootstrap_nav(@pagy) %>
